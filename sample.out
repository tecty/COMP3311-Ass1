DROP DATABASE
CREATE DATABASE
apply schema
CREATE TABLE
CREATE TABLE
CREATE TABLE
CREATE TABLE
CREATE TABLE
CREATE TABLE

apply data
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1
INSERT 0 1

apply answer views
CREATE VIEW
CREATE VIEW
CREATE VIEW
CREATE VIEW
CREATE VIEW
CREATE VIEW
CREATE VIEW
CREATE VIEW
CREATE VIEW
CREATE VIEW
CREATE VIEW
CREATE VIEW
CREATE VIEW
CREATE VIEW
CREATE VIEW
CREATE VIEW
CREATE VIEW
CREATE VIEW
CREATE VIEW
CREATE VIEW
CREATE VIEW
CREATE VIEW
CREATE VIEW
CREATE VIEW
CREATE VIEW
CREATE FUNCTION
CREATE TRIGGER
CREATE FUNCTION
CREATE TRIGGER
CREATE FUNCTION
CREATE TRIGGER

TEST Result
   name   |   country   
----------+-------------
 CCC corp | china
 EEE corp | US
 GGG corp | New Zealand
(3 rows)

 code 
------
 AAA
(1 row)

   name   
----------
 BBB corp
 DDD corp
 EEE corp
 HHH corp
(4 rows)

   sector   | number 
------------+--------
 Technology |      4
 Milk       |      3
 Services   |      1
(3 rows)

 name  
-------
 Duke
 Lucas
 Twain
(3 rows)

   name   
----------
 AAA corp
 BBB corp
(2 rows)

    Date    | code | volume  | prevprice | price | change |           gain           
------------+------+---------+-----------+-------+--------+--------------------------
 2018-05-13 | AAA  |      24 |         1 |  0.75 |  -0.25 | -25.00000000000000000000
 2018-05-14 | AAA  |      15 |      0.75 |   0.8 |   0.05 |   6.66666666666666666700
 2018-05-15 | AAA  |      11 |       0.8 |  0.93 |   0.13 |  16.25000000000000000000
 2018-05-16 | AAA  |       8 |      0.93 |   1.2 |   0.27 |  29.03225806451612903200
 2018-05-17 | AAA  |      17 |       1.2 |  1.22 |   0.02 |   1.66666666666666666700
 2018-05-18 | AAA  |      16 |      1.22 |  1.15 |  -0.07 |  -5.73770491803278688500
 2018-05-19 | AAA  |       5 |      1.15 |  1.20 |   0.05 |   4.34782608695652173900
 2018-05-13 | BBB  |  766300 |      0.91 |  0.92 |   0.01 |   1.09890109890109890100
 2018-05-14 | BBB  |  693800 |      0.92 |  0.91 |  -0.01 |  -1.08695652173913043500
 2018-05-15 | BBB  |  741800 |      0.91 |  0.90 |  -0.01 |  -1.09890109890109890100
 2018-05-16 | BBB  |  663900 |      0.90 |  0.89 |  -0.01 |  -1.11111111111111111100
 2018-05-17 | BBB  |  521500 |      0.89 |  0.89 |   0.00 |       0.0000000000000000
 2018-05-18 | BBB  |  441900 |      0.89 |  0.92 |   0.03 |   3.37078651685393258400
 2018-05-19 | BBB  |  382300 |      0.92 |  0.91 |  -0.01 |  -1.08695652173913043500
 2018-05-20 | BBB  |  388900 |      0.91 |  0.90 |  -0.01 |  -1.09890109890109890100
 2018-05-21 | BBB  |  391700 |      0.90 |  0.90 |   0.00 |       0.0000000000000000
 2018-05-22 | BBB  | 1503600 |      0.90 |  0.92 |   0.02 |   2.22222222222222222200
(17 rows)

    Date    | code | volume  
------------+------+---------
 2018-05-12 | BBB  |  766300
 2018-05-13 | BBB  |  766300
 2018-05-14 | BBB  |  693800
 2018-05-15 | BBB  |  741800
 2018-05-16 | BBB  |  663900
 2018-05-17 | BBB  |  521500
 2018-05-18 | BBB  |  441900
 2018-05-19 | BBB  |  382300
 2018-05-20 | BBB  |  388900
 2018-05-21 | BBB  |  391700
 2018-05-22 | BBB  | 1503600
(11 rows)

   sector   | industry | number 
------------+----------+--------
 Milk       | Farming  |      3
 Services   | Delivery |      1
 Technology | Chipset  |      2
 Technology | SoC      |      2
(4 rows)

 code | industry 
------+----------
 FFF  | Delivery
(1 row)

   sector   |     avgrating      
------------+--------------------
 Services   | 3.7777777777777778
 Milk       | 3.2222222222222222
 Technology | 3.0988888888888889
(3 rows)

 name 
------
 Mark
 Duke
(2 rows)

 code |   name   | address | zip  |  sector  
------+----------+---------+------+----------
 FFF  | FFF corp |         | 0255 | Services
(1 row)

 code | beginprice | endprice | change |          gain           
------+------------+----------+--------+-------------------------
 AAA  |          1 |     1.20 |   0.20 | 20.00000000000000000000
 BBB  |       0.91 |     0.92 |   0.01 |  1.09890109890109890100
(2 rows)

 code | minprice |        avgprice        | maxprice |        mindaygain        |       avgdaygain       |       maxdaygain        
------+----------+------------------------+----------+--------------------------+------------------------+-------------------------
 BBB  |     0.89 | 0.90636363636363636364 |     0.92 |  -1.11111111111111111100 | 0.12090834855856839240 |  3.37078651685393258400
 AAA  |     0.75 | 1.03125000000000000000 |     1.22 | -25.00000000000000000000 | 3.88938750953902817429 | 29.03225806451612903200
(2 rows)

INSERT 0 1
 code |        avg         
------+--------------------
 BBB  | 2.8400000000000000
(1 row)

INSERT 0 1
 code |        avg         
------+--------------------
 BBB  | 5.0000000000000000
(1 row)

INSERT 0 1
 code |          avg           
------+------------------------
 BBB  | 1.00000000000000000000
(1 row)

 Timestamp | Date | code | oldvolume | oldprice 
-----------+------+------+-----------+----------
(0 rows)

UPDATE 1
         Timestamp          |    Date    | code | oldvolume | oldprice 
----------------------------+------------+------+-----------+----------
 2019-03-26 05:36:32.083231 | 2018-05-24 | BBB  |   1503600 |      0.5
(1 row)

